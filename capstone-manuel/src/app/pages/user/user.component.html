<div
  *ngIf="user"
  class="card"
  style="width: 18rem; margin: auto; text-align: center"
>
  <div class="card-body">
    <h2 class="card-title">Profilo Utente</h2>
    <p class="card-text"><strong>Nome:</strong> {{ user.name }}</p>
    <p class="card-text"><strong>Email:</strong> {{ user.email }}</p>

    <div *ngIf="user.foto" style="margin-bottom: 1rem">
      <p><strong>Foto Profilo:</strong></p>
      <img
        [src]="'data:image/jpeg;base64,' + user.foto"
        alt="Foto profilo di {{ user.name }}"
        class="img-thumbnail"
        style="width: 150px; height: 150px; object-fit: cover"
      />
    </div>

    <div *ngIf="user.roles && user.roles.length > 0">
      <p><strong>Ruoli:</strong></p>
      <ul class="list-unstyled">
        <li *ngFor="let ruolo of user.roles">{{ ruolo }}</li>
      </ul>
    </div>

    <div *ngIf="user.personaggi && user.personaggi.length > 0">
      <p><strong>Personaggi:</strong></p>
      <ul class="list-unstyled">
        <li *ngFor="let personaggio of user.personaggi">
          <strong>{{ personaggio.nome }}</strong
          >: {{ personaggio.descrizione }}
        </li>
      </ul>
    </div>

    <div
      *ngIf="user.registrazioni && user.registrazioni.length > 0"
      style="margin-top: 2rem"
    >
      <h3>Eventi a cui {{ user.name }} Ã¨ iscritto</h3>
      <ul class="list-group">
        <li
          class="list-group-item"
          *ngFor="let registrazione of user.registrazioni"
        >
          <strong>{{ registrazione.evento.titolo }}</strong
          ><br />
          <small>Inizio: {{ registrazione.evento.dataInizio | date }}</small
          ><br />
          <small>Fine: {{ registrazione.evento.dataFine | date }}</small
          ><br />
          <small>Luogo: {{ registrazione.evento.luogo }}</small
          ><br />
          <small
            >Costo Totale: {{ registrazione.costoTotale | currency }}</small
          >
          <div
            *ngIf="registrazione.servizi && registrazione.servizi.length > 0"
            style="margin-top: 1rem"
          >
            <h4>Servizi associati:</h4>
            <ul>
              <li *ngFor="let servizio of registrazione.servizi">
                <strong>{{ servizio.nome }}</strong
                >: {{ servizio.descrizione }} (Costo:
                {{ servizio.costo | currency }})
              </li>
            </ul>
          </div>
          <button
            class=""
            btn
            btn-danger
            (click)="deleteRegistrazione(registrazione.id)"
          >
            Elimina
          </button>
        </li>
      </ul>
    </div>

    <a class="btn btn-primary" [routerLink]="['editProfile']"
      >Modifica Profilo</a
    >
  </div>
</div>

<div *ngIf="!user">
  <p>Nessun dato utente disponibile.</p>
</div>
